#!/bin/bash

# Variables
FOLDER="/home/hubi/myconfig/"
ASIMFile="${FOLDER}/asimilieren"

# Functions
asimilieren() {
cat <<ASIMILIEREN
#!/bin/bash

# !!!
# Not working yet!
# !!!

FOLDER="/home/hubi/myconfig/"

while IFS= read -r LINE; do
  echo \${LINE##* }

  # TODO:
  #     * Abfrage geht noch nicht!
  #     * Sudo, wenn nÃ¶tig

  read -p "\${LINE##* }? " -n 1 -r
  if [[ \$REPLY =~ ^[Yy]$ ]]; then
      exit 1
  fi
done <<COMMANDS
ASIMILIEREN
}

#RUN
asimilieren >$ASIMFile

echo "copy"
echo

while IFS= read -r FILE; do
  [[ ! $FILE == \#* ]] && {
    BASE=${FILE##*/}
    BASE=${BASE#.}
    [[ $BASE == *"*"* ]] && BASE=""
    DIR=""
    [[ $FILE == ~* ]] && {
      FILE=${FILE#\~}
      DIR=${FILE%/*}
      [[ $DIR != "" ]] && {
        DIR=${DIR#*/}"/"
        DIR=${DIR#.}
      }
      FILE="/home/hubi"${FILE}
    } || {
      DIR=${FILE%/*}
      DIR=${DIR#*/}"/"
      DIR=${DIR#.}
    }
    mkdir -p "${FOLDER}${DIR}"
    cp -vu $FILE "${FOLDER}${DIR}${BASE}"

    echo "\${FOLDER}${DIR}${BASE} $FILE" >> "$ASIMFile"
  }
done <<FILES
~/.Xresources
~/.aliasrc
~/.asoundrc.default
~/.asoundrc.hdmi-connected
~/.asoundrc.uca202
~/.bash_profile
~/.bashrc
~/.emacs
~/.fontconfig/fonts.conf
~/.ghci
~/.mutt/colors.solarized-light
~/.tmux.conf
~/.vimencrypt
~/.vimrc
~/.vimrc-neo
~/.xinitrc
~/.xmonad/myinformation.sh
~/.xmonad/showkeys
~/.xmonad/xmobarrc
~/.xmonad/xmonad.hs
~/.zshrc.local
~/bin/disp-controll
~/bin/installiere_neo
~/bin/mailclient.sh
~/bin/mailrun.sh
~/bin/myautosetup.sh
~/bin/mycrypt
~/bin/myfsize.sh
~/bin/myfullbackup.sh
~/bin/mylayouttoggle.sh
~/bin/ncChat.sh
~/bin/nmgui
~/bin/remove_spaces.sh
~/bin/runNL.sh
/etc/X11/xorg.conf.d/*.conf
/etc/hosts
/etc/locale.conf
/etc/mkinitcpio.conf
/etc/modprobe.d/*
/etc/pacman.conf
/etc/vconsole.conf
/etc/vsftpd.conf
/usr/share/kbd/keymaps/neo/*
FILES

echo "COMMANDS" >> "$ASIMFile"

echo
echo "git"
echo

cd "$FOLDER"
git add .
git commit -a -m "aktualisiert"
git push
